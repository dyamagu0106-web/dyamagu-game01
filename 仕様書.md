# SPACE ASSAULT 8-BIT ゲーム仕様書

## プロジェクト概要
HTML5 Canvas を使用して開発された8ビット風縦スクロールシューティングゲームです。プレイヤーが宇宙船を操縦し、降ってくるエイリアンを撃退しながらステージをクリアしていくアクションシューティングゲームです。

## 技術仕様

### 基本構成
- **HTML**: index.html - ゲームのメインページ
- **JavaScript**: script.js - ゲームロジック（1300行以上）
- **CSS**: style.css - スタイリング
- **画像フォルダ**: images/ - ゲーム内で使用するスプライト
- **音声フォルダ**: sounds/ - BGMと効果音

### 技術スタック
- HTML5 Canvas
- Vanilla JavaScript (ES6+)
- Web Audio API
- Keyboard API + Gamepad API
- Google Fonts (Press Start 2P)

## ゲーム仕様

### 基本ゲームフロー
1. **スタート画面**: "SPACE ASSAULT 8-BIT" タイトル表示
2. **ゲームプレイ**: エイリアン撃退とボス戦
3. **ステージクリア**: ボス撃破後の次ステージ移行
4. **ゲームオーバー**: ライフ0時の終了画面

### プレイヤー仕様
- **移動**: 360度自由移動（画面端制限あり）
- **サイズ**: 50x50ピクセル
- **初期移動速度**: 4ピクセル/フレーム（パワーアップで最大7まで向上）
- **初期ライフ**: 3
- **武器**: 弾丸（最大4発同時発射可能）
- **射撃クールダウン**: 150ms（パワーアップで最大30msまで短縮）

### 敵キャラクター仕様

#### 通常エイリアン
- **サイズ**: 40x30ピクセル
- **種類**: 12種類の画像とAIパターン（各キャラが固有の動きをする）
- **出現ルール**: 各ステージ3種類まで
- **移動パターン**: 
  - 0: 直進下降
  - 1: 水平移動付き下降
  - 2: サイン波移動
  - 3: 対角バウンス
  - 4: 一時停止移動
  - 5: ホーミング
  - 6: 高速急降下
  - 7: 円形移動
  - 8: 8の字移動
  - 9: 壁バウンス
  - 10: 水平ダッシュ
  - 11: 狙い撃ち

#### スクワッドエイリアン（編隊）
- **構成**: リーダー1体 + フォロワー3体 = 4機編隊
- **間隔**: 55px間隔（40px幅 + 15px隙間）
- **特徴**: リーダーの移動をフォロワーが追従、緑色フィルター表示
- **リーダー交代**: リーダー撃破時に自動でフォロワーが昇格
- **報酬**: 編隊全滅時にパワーアップカプセル出現

#### ボス
- **サイズ**: 150x100ピクセル
- **体力**: 50 × ステージ数
- **出現条件**: 雑魚敵20体撃破後
- **移動速度**: 基本速度2、ステージごとに8%ずつ増加
- **基本攻撃**: 3方向同時弾発射（中央・左・右）
- **特殊攻撃**:
  - **2面以降**: ダイブアタック（3倍速度で突進）
  - **3面以降**: 扇状弾攻撃（4回に1回、5発扇状、通常弾の0.5倍速度）
  - **4面以降**: 誘導弾攻撃（扇状弾と同時発射、2秒間誘導、オレンジ色）

## パワーアップシステム
1. **スピードアップ（緑・S）**: 最大3段階、移動速度+1/段階
2. **連射アップ（青・R）**: 最大7段階
   - クールダウン-15ms/段階（最低30ms）
   - 弾速+8%/段階
   - 画面上弾数増加（2レベルごとに+1発）
3. **ワイドショット（マゼンタ・W）**: 最大3段階
   - レベル1: 3発扇状（±15度）
   - レベル2: 5発扇状（±15度、±30度）
   - レベル3: 7発扇状（±10度、±20度、±30度）
   - **最大レベル時の特殊効果**: さらにワイドショットを取得すると連射レベルアップ

### パワーアップ弾数計算
- **通常弾**: 基本4発 + Math.floor(連射レベル/2)発
- **ワイドショット**: 発射弾数 × (1 + Math.floor(連射レベル/2))

### スコアシステム
- **エイリアン撃破**: 100点
- **ボス攻撃ヒット**: 50点
- **ボス撃破**: 5000点
- **パワーアップ取得**: 500点

### ステージシステム
- **ボス出現条件**: エイリアン20体撃破
- **ステージクリア**: ボス撃破後8秒で次ステージ自動移行
- **難易度上昇**: ステージごとに敵速度増加（基本速度2 + (ステージ-1) × 0.5）
- **新敵種追加**: ステージ進行で2体ずつ新種追加、最大3種類まで

## 弾丸仕様
- **プレイヤー弾**: 薄い黄色（#ffff99）、基本速度7、連射レベルで8%ずつ速度向上
- **プレイヤー弾数制限**: 通常4発、連射・ワイドショットレベルで増加
- **敵通常弾**: 赤色、速度5
- **敵扇状弾**: 赤色、速度2.5（通常弾の0.5倍）
- **敵誘導弾**: オレンジ色、速度5、発射後2秒間誘導

## ゲーム状態管理
- **start**: タイトル画面
- **playing**: ゲームプレイ中
- **paused**: ポーズ中（ESC/STARTで切り替え）
- **respawning**: 被弾後3秒間の無敵時間
- **gameover**: ゲームオーバー
- **stage_clear**: ステージクリア演出

### 復活システム仕様
- **通常ステージ**: 被弾時は3秒後にステージ全体をリスタート
- **ボス戦中**: 被弾時はボスの状態（ダメージ・位置・攻撃パターン）を維持し、プレイヤーのみ3秒後に復活
  - ボスのHP・位置・移動状態は変更されない
  - プレイヤー弾のみクリア、敵弾・ボス状態は維持
  - 復活位置は画面下部中央（x: 画面幅/2-25, y: 画面高-60）

### 操作仕様

#### キーボード操作
- **移動**: 矢印キー または WASD
- **射撃**: スペースキー
- **ポーズ**: ESCキー
- **ゲーム開始/再開**: スペースキー

#### ゲームパッド対応
- **移動**: 左アナログスティック または 十字キー
- **射撃**: Aボタン
- **ポーズ**: STARTボタン
- **ゲーム開始/再開**: STARTボタン
- **デッドゾーン**: 0.25

### 視覚効果
- **背景**: 流れ星エフェクト（100個の星）
  - 通常ステージ: 速度1ピクセル/フレーム
  - 4ステージごと: 速度6倍（高速スクロール演出）
- **爆発エフェクト**: 黄色円形、アルファ値減衰
- **フォント**: レトロ風 "Press Start 2P"
- **色彩**: 緑基調のUI、赤色の敵弾

### 音響仕様
- **オープニングBGM**: opening.mp3（ループ）
- **ゲームBGM**: bgm.mp3（ループ）
- **ボスBGM**: boss.mp3（ループ）
- **効果音**:
  - 射撃音: shoot.mp3
  - 爆発音: explosion.mp3
  - ゲームオーバー: gameover.mp3
  - ファンファーレ: fanfare.mp3

### 衝突判定
- **矩形判定**: 全オブジェクト間で実装
- **プレイヤー vs エイリアン**: ライフ減少
- **プレイヤー vs 敵弾**: ライフ減少
- **プレイヤー vs ボス**: ライフ減少
- **プレイヤー弾 vs エイリアン**: 撃破
- **プレイヤー弾 vs ボス**: ダメージ

### ゲームステート管理
- **start**: 開始画面
- **playing**: ゲーム中
- **gameover**: ゲーム終了
- **stage_clear**: ステージクリア

### パフォーマンス仕様
- **フレームレート**: 60fps（requestAnimationFrame使用）
- **弾丸制限**: プレイヤー弾基本4発（パワーアップで増加）
- **敵出現間隔**: 40-120フレーム（ランダム）
- **編隊出現確率**: 30%

### パワーアップ効果詳細
#### 連射レベル別効果表
| レベル | クールダウン | 弾速倍率 | 通常弾数 | ワイド3発 | ワイド5発 | ワイド7発 |
|--------|-------------|---------|---------|----------|----------|----------|
| 0      | 150ms       | 1.00倍  | 4発     | 3発      | 5発      | 7発      |
| 1      | 135ms       | 1.08倍  | 4発     | 3発      | 5発      | 7発      |
| 2      | 120ms       | 1.16倍  | 5発     | 6発      | 10発     | 14発     |
| 3      | 105ms       | 1.24倍  | 5発     | 6発      | 10発     | 14発     |
| 4      | 90ms        | 1.32倍  | 6発     | 9発      | 15発     | 21発     |
| 5      | 75ms        | 1.40倍  | 6発     | 9発      | 15発     | 21発     |
| 6      | 60ms        | 1.48倍  | 7発     | 12発     | 20発     | 28発     |
| 7      | 45ms        | 1.56倍  | 7発     | 12発     | 20発     | 28発     |

#### ボス速度倍率表
| ステージ | 速度倍率 | 実際の速度 |
|----------|----------|------------|
| 1        | 1.00倍   | 2.0        |
| 2        | 1.08倍   | 2.16       |
| 3        | 1.16倍   | 2.32       |
| 4        | 1.24倍   | 2.48       |
| 5        | 1.32倍   | 2.64       |

## リソース構成

### 画像ファイル（images/）
- player.png - プレイヤー機体
- alien1.png～alien12.png - エイリアン12種類
- boss.png - ボス機体

### 音声ファイル（sounds/）
- BGM: opening.mp3, bgm.mp3, boss.mp3
- 効果音: shoot.mp3, explosion.mp3, gameover.mp3, fanfare.mp3

## 特記事項
- ブラウザの自動再生ポリシーに対応（音声再生エラーハンドリング）
- ゲームパッド API を使用したコントローラー対応
- ポーズ機能（ESC/STARTボタン）実装
- ライフシステムによる復活機能あり（残機制）
- スクワッド型エイリアンの高度なAI実装
- 多段階パワーアップシステムによる成長要素
- ボスの複雑な攻撃パターン（扇状弾・誘導弾）
- 被弾後3秒間のリスポーン無敵時間
- 連射アップによる弾速・弾数の複合強化
- ワイドショット最大時の連射レベル転換システム
- ステージ進行によるボス速度動的調整
- ボス戦専用復活システム（ボス状態維持）
- 4ステージごとの背景超高速スクロール演出（6倍速）

## 開発・動作環境
- 現代的なWebブラウザ（Chrome, Firefox, Safari, Edge）
- HTML5 Canvas対応必須
- Web Audio API対応推奨
- ローカルファイルアクセス可能な環境